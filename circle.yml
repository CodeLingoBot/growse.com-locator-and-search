machine:
  environment:
    JEKYLL_ENV: production

compile:
  override:
    - bundle exec jekyll b -d $CIRCLE_ARTIFACTS
    - fpm -s dir -t deb -n growse-com-jekyll --prefix /var/www/ -p $CIRCLE_ARTIFACTS -a noarch  -v 1.0.0-$CIRCLE_BUILD_NUM $CIRCLE_ARTIFACTS/=growse-jekyll
test:
  override:
    - echo "Oh yeah!" # No way to test Jekyll. Just do something to satisfy CircleCI.
deployment:
  production:
    branch: jekyll
    commands:
      - deb-s3 upload --s3-region=eu-west-1 --bucket apt-growse-com $CIRCLE_ARTIFACTS/growse-com-jekyll_1.0.0-"$CIRCLE_BUILD_NUM"_all.deb
